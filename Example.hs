import TheNutcracker
import System.Process

play wave = do
  saveWaveToRawFile "output.bin" wave
  handler <- runCommand "ffplay -loglevel quiet -showmode 1 -autoexit -f f32le -ar 48000 output.bin"
  waitForProcess handler

sampleRate = 48000
volume     = 1/2
tune       = 440
tone       = ("D", 4)

music = [ (2,  1/2) -- init
        , (2,  1/2)
        , (3,  1/2)
        , (5,  1/2)
        , (5,  1/2)
        , (3,  1/2)
        , (2,  1/2)
        , (0,  1/2)

        , (-2, 1/2)
        , (-2, 1/2)
        , (0,  1/2)
        , (2,  1/2)
        , (2,  3/4)

        , (0,  1/4)
        , (0,  1)

        , (2,  1/2) -- variation
        , (2,  1/2)
        , (3,  1/2)
        , (5,  1/2)
        , (5,  1/2)
        , (3,  1/2)
        , (2,  1/2)
        , (0,  1/2)

        , (-2, 1/2)
        , (-2, 1/2)
        , (0,  1/2)
        , (2,  1/2)
        , (0,  3/4)

        , (-2, 1/4)
        , (-2, 1)

        , (0,  1/2) -- bridge
        , (0,  1/2)
        , (2,  1/2)
        , (-2,  1/2)
        , (0,  1/2)

        , (2,  1/4)
        , (3,  1/4)
        , (2,  1/2)
        , (-2,  1/2)
        , (0,  1/2)

        , (2,  1/4)
        , (3,  1/4)
        , (2,  1/2)
        , (0,  1/2)
        , (-2,  1/2)
        , (0,  1/2)
        , (-7,  1)

        , (2,  1/2) -- variation
        , (2,  1/2)
        , (3,  1/2)
        , (5,  1/2)
        , (5,  1/2)
        , (3,  1/2)
        , (2,  1/2)
        , (0,  1/2)

        , (-2, 1/2)
        , (-2, 1/2)
        , (0,  1/2)
        , (2,  1/2)
        , (0,  3/4)

        , (-2, 1/4)
        , (-2, 1)

        , (0,  1/2) -- bridge
        , (0,  1/2)
        , (2,  1/2)
        , (-2,  1/2)
        , (0,  1/2)

        , (2,  1/4)
        , (3,  1/4)
        , (2,  1/2)
        , (-2,  1/2)
        , (0,  1/2)

        , (2,  1/4)
        , (3,  1/4)
        , (2,  1/2)
        , (0,  1/2)
        , (-2,  1/2)
        , (0,  1/2)
        , (-7,  1)

        , (2,  1/2) -- variation
        , (2,  1/2)
        , (3,  1/2)
        , (5,  1/2)
        , (5,  1/2)
        , (3,  1/2)
        , (2,  1/2)
        , (0,  1/2)

        , (-2, 1/2)
        , (-2, 1/2)
        , (0,  1/2)
        , (2,  1/2)
        , (0,  1)

        , (-2, 1/4)
        , (-2, 5/4)
        ]

main = do
  play $ quickMusic volume 0.001 sampleRate tune tone music
